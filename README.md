# Syllable Classifier: Using supervised Machine Learning to predict whether a syllable is Gurung or Nepali

## Abstract
This project uses data from my doctoral dissertation (Ronkos 2020) to see whether a supervised Machine Learning model can be trained to correctly classify syllables as belonging to one of two languages -- Gurung, a Tibeto-Burman minority language of Nepal, or Nepali, an Indo-Aryan language that is the official langauge of Nepal. The data is coded differently for consonants and vowels; consonants are described using categorical features since the methods of acoustically measuring consonants vary greatly depending on the type of consonant (i.e. voice onset time for obstruents but formants for sonorants), while vowels are coded using acoustic data extracted from recorded soundfiles using the open source software Praat (Boersema & Weenik 2022). The soundfiles were recorded with the help of 5 speakers of Gurung and 5 speakers of Nepali using a Sennheiser ME66 microphone and a Zoom H4N recorder, and together comprise a fairly balanced dataset of 5,099 syllables (2,313 Gurung syllables and 2,786 Nepali syllables). Using Scikit Learn, I fit a baseline Logistic Regression model to see if it would perform better than chance. This initial model had an acccracy of 0.767. After some attempts at additional feature engineering did not increase performance, I ultimately fit a Stacking Ensemble model that combined K-Nearest Neighbors, Decision Tree, and Logistic Regression models to achieve an accuracy of 0.91. This suggests that coding syllables using the features linguists have determined are useful in human speech perception may also be useful in machine learning classification of speech. Ths has applications in automatic speech recognition, accent or language detection, or other circumstances where it may be useful to detect a novel speaker's language using only syllable information rather than relying on pre-training a model on entire words or sentences.

## Data
The data for this project comes from wordlists of ~92 words recorded with the help of 5 speakers of Gurung and 5 speakers of Nepali. Each speaker was recorded saying each word three times each in isolation. The recordings were made using a Sennheiser ME66 microphone and a Zoom H4N recorder. The elicitation sessions took place in 2017 in New York City, as well as Sikles Village and Kathmandu, Nepal. 

Each recording was processed using Praat (Boersema & Weenik 2022), an open source software for phonetic and acoustic analysis commonly used in linguistics that allows the easy measurement of waveforms and generation of spectrograms. The boundaries of the vowels in each word were aligned and transcribed by hand. Then a Praat Script by Stanley & Lipani (2019) was used to automatically extract measurements in Hertz for the first formant (F1), second formant (F2), third formant (F3), and measurements for the duration in milliseconds for each vowel in each word. Additionally, vowel nasalization (a contrastive feature in both languages) was coded categorically (nasal or not nasal), and syllable number was coded categorically (is it the first syllable in the word, second syllable in the word, etc.) to distinguish observations of the same vowel within different syllables of the same word (i.e. the Gurung word _tsada_ 'small' has two _a_ vowels, one in the first syllable and one in the second syllable.)

The consonants were coded categorically so they could be compared across all words -- onset consonants were coded for manner of articulation (limited to labial, coronal, dorsal, or none), place of articulation (limited to obstruent, sonorant, or none), and laryngeal state (a way of accounting for both breathy phonation and aspiration phonetically present in both languages but phonologically encoded differently in each language). Coda consonants were simply coded as present or absent (mapping to open or closed syllables). 

## Algorithms
I used Python and Scikit Learn to build several Logistic Regression and K-Nearest Neighbors classification models, as well as a Stacked Ensemble model that ultimately performed the best when it came to accurately classifying syllables. All models were split into train and test sets, and used cross-validation to ensure the model was not overfitting to the training data.

Although I did not realize it at the time, the choices I made in encoding the consonant data were essentially preemptive feature engineering. Rather than coding for all 8 manners of articulation across both languages (stop, fricative, affricate, nasal, trill, lateral fricative, lateral approximant, approximant), I condensed them into the two larger natural classes of obstruent and sonorant. Rather than coding for all 7 places of articulation across both languages (bilabial, dental, alveolar, retroflex, palatal, velar, glottal), I condensed them into three larger natural classes of labial, coronal, and dorsal. I also chose not to encode any place or manner features for the coda consonants, as I suspected that merely knowing whether a syllable was open (no coda consonant) or closed (coda consonant) would be the most useful for the model.

I did attempt additional feature engineering on the acoustic vowel measurements. Linguists commonly think of formants as ways of plotting vowels in the vowel space, but I also thought it might be useful to look at the distance between formants (i.e. one thing that distinguishes the front vowel /i/ from the back vowel /u/ is the distance between the first and second formants; it should be much greater for the front vowel than for the back vowel). This did not turn out to be useful feature engineering, and actually decreased the accuracy for KNN and Logistic Regression models trained on these features instead of the raw measurements.

The model with the best accuracy (0.91) was the Ensemble model. This Stacking model combined KNN, Decision Tree, and Logistic Regression models, with a Logistic Regression model serving as the meta model determining the best parameters. This combination actually makes sense based on my understanding of the features encoding each syllable. I would expect a KNN model to perform very well on the acoustic vowel measurements, since a KNN model sort of mirrors the way linguists think human speech perception works -- each individual production of a vowel is recognized by the listener based on how closely it resembles one of the abstract vowel categories the listener has formed based on previous vowel input. I would expect a Decision Tree model to perform well on the categorical consonant features -- it would be very easy to partition the data based on coda consonant distribution (Nepali seems to have more coda consonants) or onset consonant distribution (Gurung seems to have more onset consonants that are sonorants). And I would expect a Logistic Regression model to perform well on vowel duration data, since although the two languages have similar vowel systems, Gurung has additional short vowels Nepali lacks that should cluster at the lower end of the distribution. Since each of these models is best suited for only some for the syllable features encoded in the data, it makes sense that using all of them together in an Ensemble would provide the best results.
  
## Tools
  - Praat to annotate and extract acoustic data
  - Excel to annotate categorical data
  - Python and Pandas to merge and clean categorical and acoustic data, as well as perform EDA
  - Scikit Learn to train various classification models and plot confusion matrices

## References
Boersma, Paul & Weenink, David (2022). Praat: doing phonetics by computer [Computer program]. Version 6.2.12, retrieved 28 March 2022 from http://www.praat.org/

Ronkos, D. A. (2020). The Sounds of Sikles Gurung: A Phonetic and Phonological Description of a Tibeto-Burman Language of Nepal. Doctoral Dissertation, The Graduate Center, CUNY.

Stanley, J. & Lipani, L. (2019). Automatic Formant Extraction in Praat. Accessed 28 March 2022 from https://joeystanley.com/downloads/191002-formant_extraction
  
## Communication
  [Classification_slides.pdf](https://github.com/dr-dronkos/Classifying-Syllables-Classification-Metis/files/8518107/Classification_slides.pdf)

